--[[
Module for rendering a custom pixel font.
]]
local CustomFont = {}

-- Font definition. Each character is 6x8 pixels.
-- The space ' ' represents an off pixel, any other character is an on pixel.
-- This is a conscious decision, I don't want to use external assets like fonts or sprites,
-- it's an interesting exercise to draw text manually.
CustomFont.glyphs = {
  ["A"] = {
    "      ",
    " 1111 ",
    "11   1",
    "11   1",
    "111111",
    "11   1",
    "11   1",
    "11   1",
  },
  ["B"] = {
    "      ",
    "11111 ",
    "11   1",
    "11   1",
    "11111 ",
    "11   1",
    "11   1",
    "11111 ",
  },
  ["C"] = {
    "      ",
    " 11111",
    "11    ",
    "11    ",
    "11    ",
    "11    ",
    "11    ",
    " 11111",
  },
  ["D"] = {
    "      ",
    "11111 ",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    "11111 ",
  },
  ["E"] = {
    "      ",
    "111111",
    "11    ",
    "11    ",
    "1111  ",
    "11    ",
    "11    ",
    "111111",
  },
  ["F"] = {
    "      ",
    "111111",
    "11    ",
    "11    ",
    "11111 ",
    "11    ",
    "11    ",
    "11    ",
  },
  ["G"] = {
    "      ",
    " 11111",
    "11    ",
    "11    ",
    "11 111",
    "11   1",
    "11   1",
    "  1111",
  },
  ["H"] = {
    "      ",
    "11   1",
    "11   1",
    "11   1",
    "111111",
    "11   1",
    "11   1",
    "11   1",
  },
  ["I"] = {
    "      ",
    "111111",
    "  11  ",
    "  11  ",
    "  11  ",
    "  11  ",
    "  11  ",
    "111111",
  },
  ["J"] = {
    "      ",
    " 11111",
    "    11",
    "    11",
    "    11",
    "11   1",
    "11   1",
    " 1111 ",
  },
  ["K"] = {
    "      ",
    "11   1",
    "11  1 ",
    "11 1  ",
    "111   ",
    "11 1  ",
    "11  1 ",
    "11   1",
  },
  ["L"] = {
    "      ",
    "11    ",
    "11    ",
    "11    ",
    "11    ",
    "11    ",
    "11    ",
    "111111",
  },
  ["M"] = {
    "      ",
    "11   1",
    "111 11",
    "11 1 1",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
  },
  ["N"] = {
    "      ",
    "11   1",
    "111  1",
    "111  1",
    "11 1 1",
    "11 1 1",
    "11  11",
    "11  11",
  },
  ["O"] = {
    "      ",
    " 1111 ",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    " 1111 ",
  },
  ["P"] = {
    "      ",
    "11111 ",
    "11   1",
    "11   1",
    "11   1",
    "11111 ",
    "11    ",
    "11    ",
  },
  ["Q"] = {
    "      ",
    " 1111 ",
    "11   1",
    "11   1",
    "11   1",
    "11 1 1",
    "11  1 ",
    " 111 1",
  },
  ["R"] = {
    "      ",
    "11111 ",
    "11   1",
    "11   1",
    "11   1",
    "11111 ",
    "11   1",
    "11   1",
  },
  ["S"] = {
    "      ",
    " 11111",
    "11    ",
    "11    ",
    " 1111 ",
    "    11",
    "    11",
    "11111 ",
  },
  ["T"] = {
    "      ",
    "111111",
    "  11  ",
    "  11  ",
    "  11  ",
    "  11  ",
    "  11  ",
    "  11  ",
  },
  ["U"] = {
    "      ",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    " 1111 ",
  },
  ["V"] = {
    "      ",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    " 11 1 ",
    "  11  ",
  },
  ["W"] = {
    "      ",
    "11   1",
    "11   1",
    "11   1",
    "11   1",
    "11 1 1",
    "11 1 1",
    " 11 1 ",
  },
  ["X"] = {
    "      ",
    "11   1",
    "11   1",
    " 11 1 ",
    "  11  ",
    " 11 1 ",
    "11   1",
    "11   1",
  },
  ["Y"] = {
    "      ",
    "11   1",
    "11   1",
    "11   1",
    " 11 1 ",
    "  11  ",
    "  11  ",
    "  11  ",
  },
  ["Z"] = {
    "      ",
    "111111",
    "    11",
    "   11 ",
    "  11  ",
    " 11   ",
    "11    ",
    "111111",
  },

  ["0"] = {
    "      ",
    "11111 ",
    "11  1 ",
    "11  1 ",
    "11  1 ",
    "11  1 ",
    "11  1 ",
    "11111 ",
  },
  ["1"] = {
    "      ",
    " 11   ",
    "111   ",
    " 11   ",
    " 11   ",
    " 11   ",
    " 11   ",
    " 11   ",
  },
  ["2"] = {
    "      ",
    "11111 ",
    "   11 ",
    "   11 ",
    "11111 ",
    "11    ",
    "11    ",
    "11111 ",
  },
  ["3"] = {
    "      ",
    "11111 ",
    "   11 ",
    "   11 ",
    " 1111 ",
    "   11 ",
    "   11 ",
    "11111 ",
  },
  ["4"] = {
    "      ",
    "11  1 ",
    "11  1 ",
    "11  1 ",
    "11111 ",
    "   11 ",
    "   11 ",
    "   11 ",
  },
  ["5"] = {
    "      ",
    "11111 ",
    "11    ",
    "11    ",
    "11111 ",
    "   11 ",
    "   11 ",
    "11111 ",
  },
  ["6"] = {
    "      ",
    "11111 ",
    "11    ",
    "11    ",
    "11111 ",
    "11  1 ",
    "11  1 ",
    "11111 ",
  },
  ["7"] = {
    "      ",
    "11111 ",
    "   11 ",
    "   11 ",
    "   11 ",
    "   11 ",
    "   11 ",
    "   11 ",
  },
  ["8"] = {
    "      ",
    "11111 ",
    "11  1 ",
    "11  1 ",
    "11111 ",
    "11  1 ",
    "11  1 ",
    "11111 ",
  },
  ["9"] = {
    "      ",
    "11111 ",
    "1  11 ",
    "1  11 ",
    "11111 ",
    "   11 ",
    "   11 ",
    "11111 ",
  },
  ["."] = {
    "  ",
    "  ",
    "  ",
    "  ",
    "  ",
    "  ",
    "11",
    "11",
  },
  [":"] = {
    "  ",
    "  ",
    "11",
    "11",
    "  ",
    "  ",
    "11",
    "11",
  },
  ["!"] = {
    "11",
    "11",
    "11",
    "11",
    "11",
    "11",
    "  ",
    "11",
  },
  ["+"] = {
    "      ",
    "      ",
    "  11  ",
    "  11  ",
    "111111",
    "111111",
    "  11  ",
    "  11  ",
  },
  ["-"] = {
    "      ",
    "      ",
    "      ",
    "      ",
    "111111",
    "111111",
    "      ",
    "      ",
  },
  ["/"] = {
    "   11",
    "   11",
    "  11 ",
    "  11 ",
    " 11  ",
    " 11  ",
    "11   ",
    "11   ",
  },
  [","] = {
    "     ",
    "     ",
    "     ",
    "     ",
    "11   ",
    "11   ",
    " 1   ",
    "1    ",
  },
  [" "] = { " ", " ", " ", " ", " ", " ", " ", " " },
}

CustomFont.charWidth = 6
CustomFont.charHeight = 8
CustomFont.tracking = 1 -- Horizontal space between characters
CustomFont.spaceWidth = 2 -- Custom width for space
CustomFont.glyphWidths = {} -- Will store actual widths

function CustomFont:init()
  for char, glyph in pairs(self.glyphs) do
    if char == " " then
      self.glyphWidths[char] = self.spaceWidth
    else
      local maxWidth = 0
      for _, rowStr in ipairs(glyph) do
        for col = #rowStr, 1, -1 do
          if rowStr:sub(col, col) ~= " " then
            maxWidth = math.max(maxWidth, col)
            break
          end
        end
      end
      self.glyphWidths[char] = maxWidth
    end
  end
end

return CustomFont
